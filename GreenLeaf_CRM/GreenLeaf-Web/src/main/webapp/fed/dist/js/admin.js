!function(a){var b={logoutApi:domain.indexOf("local.17173.com")>-1?"http://ermp.local.17173.com/sso/logonOut.do":"http://ermp.test.17173.com/manager/sso/logonOut.do",init:function(){var a=this;a.cacheElement(),a.logout(),a.ininMessage(),Ermpdock.init()},cacheElement:function(){var b=this;b.$logout=a("#J_Logout"),b.$btn=a("#J_MessageBox")},ininMessage:function(){var a=this;Ermpmessage&&(Ermpmessage.init({position:"fixed",top:60,right:35,onStatusChange:function(b){a.popStatuChange.call(a,b)}}),a.getUnreadCount())},getUnreadCount:function(){var a=this;Ermpmessage.getUnreadCount(function(b){a.popStatuChange.call(a,b)})},popStatuChange:function(a){var b=this;a&&a>0?b.enablePop():b.unablePop()},enablePop:function(){var a=this;a.$btn.addClass("message-center-box-hint"),a.$btn.unbind("click").bind("click",function(){Ermpmessage.show()})},unablePop:function(){var a=this;a.$btn.removeClass("message-center-box-hint"),a.$btn.unbind("click").bind("click",function(){window.location.href="http://ermp.local.17173.com/mycenter/message.htm"})},logout:function(){var b=this;b.$logout.on("click",function(){a.ajax({url:b.logoutApi,data:{ticket:b.getCookie("ErmpTicket"),token:b.getCookie("ErmpToken")},dataType:"jsonp",success:function(a){a.data&&(b.removeCookie("ErmpTicket"),b.removeCookie("ErmpToken"),window.location.href="/")}})})},removeCookie:function(a){var b=new Date(1990,6,19),c="; expires="+b.toUTCString();document.cookie=a+'=""'+c+"; path=/; domain="+domain},getCookie:function(a){if(document.cookie.length>0){var b=document.cookie.indexOf(a+"=");if(-1!=b){b=b+a.length+1;var c=document.cookie.indexOf(";",b);return-1==c&&(c=document.cookie.length),decodeURIComponent(document.cookie.substring(b,c))}}return""}};b.init()}(jQuery);